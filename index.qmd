---
title: "Quién es quién en<br>$CO^2$ en el mundo"
autor: G. Barrios
format: dashboard
logo: img/logo.png
---

```{python}

import pandas as pd
import plotly.express as px
import colormaps as cmaps
import seaborn as sns
from itables import show
# from itables import init_notebook_mode

# init_notebook_mode(all_interactive=True)


def filtra_maxyear(co2):
    return co2[co2.Year == co2.Year.max()]

 
f = "data/co-emissions-per-capita.csv"
co2_percapita = pd.read_csv(f)
co2_percapita = filtra_maxyear(co2_percapita)

f = "data/co2-intensity.csv"
co2_intensity = pd.read_csv(f)
co2_intensity = filtra_maxyear(co2_intensity)

f = "data/annual-co2-emissions-per-country.csv"
co2_percountry = pd.read_csv(f)
co2_percountry = filtra_maxyear(co2_percountry)



f = "data/annual-co2-emissions-per-country.csv"
co2 = pd.read_csv(f)
entities = co2.Entity.unique()

incomes = [entity for entity in entities if "income" in entity]
co2_income = co2[co2.Entity.isin(incomes)]




```

# CO₂ en el mundo


## Row 


```{python}
co2_income['Entity'] = co2_income['Entity'].replace({
    'High-income countries': 'Ingresos altos',
    'Low-income countries': 'Ingresos bajos',
    'Lower-middle-income countries': 'Ingreso medios-bajs',
    'Upper-middle-income countries': 'Ingresos medios-altos'
})



fig = px.area(
    co2_income, 
    x='Year', 
    y='Annual CO₂ emissions', 
    color='Entity', 
    labels={
        'Year': '', 
        'Annual CO₂ emissions': 'CO₂ [ton]',
        'Entity': 'ssssssssssssssssssss sss'
    },
)
fig.update_layout(legend=dict(
    yanchor="top",
    y=0.99,
    xanchor="left",
    x=0.01
))


```





# CO₂ per cápita
El **CO₂ per cápita**  es una medida que representa la cantidad promedio de dióxido de carbono (CO₂) emitido por cada persona en un país o región en un período específico, generalmente expresado en toneladas por año. Es un indicador que refleja el impacto ambiental en relación con la población.

Aqui van unas cards que calculan cuanto se emite en el país que emite más per capita, menos y México como referencia, especificando por habitante

## Row

### Emisiones per cápita {width=75%}

```{python}

colors = sns.color_palette("rocket", n_colors=10).as_hex()

fig = px.choropleth(
    co2_percapita, 
    locations='Code', 
    color="Annual CO₂ emissions (per capita)",  
    hover_name='Entity', 
    color_continuous_scale=colors,  
    labels={"Annual CO₂ emissions (per capita)": 'CO₂<br>[ton]'},
)

fig.update_layout(
    coloraxis_colorbar=dict(
        orientation='h',  
        x=0.5,  
        y=-0.15,  
        len=0.9
    ),
    margin={"r":0,"t":50,"l":0,"b":50}, 
    geo=dict(
        showframe=False,  
        showcoastlines=False,  
        showland=False, 
    )
)


```


### Datos {width=25%}

```{python}
co2_percapita.sort_values(by="Annual CO₂ emissions (per capita)",inplace=True, ascending=False)
co2_percapita.rename(columns={"Annual CO₂ emissions (per capita)":"CO₂"},inplace=True)
show(co2_percapita[["Entity","CO₂"]].round(1),showIndex=False)
```

